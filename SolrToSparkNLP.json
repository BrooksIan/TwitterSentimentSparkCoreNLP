{"paragraphs":[{"title":"Download Stanford Core NLP Jars","text":"%sh\n\nwget -O /tmp/stanford-corenlp-full-2018-02-27.zip http://nlp.stanford.edu/software/stanford-corenlp-full-2018-02-27.zip\n\nunzip /tmp/stanford-corenlp-full-2018-02-27.zip\n","user":"admin","dateUpdated":"2018-05-23T15:03:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526689844773_-238972078","id":"20180519-003044_409489110","dateCreated":"2018-05-19T00:30:44+0000","dateStarted":"2018-05-19T00:34:06+0000","dateFinished":"2018-05-19T00:34:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10490"},{"title":"Load Dependency - Solr to Spark Connector","text":"%dep\nz.load(\"com.lucidworks.spark:spark-solr:jar:3.4.4\")\n\n//Must be used before SparkInterpreter (%spark2) initialized\n//Hint: put this paragraph before any Spark code and restart Zeppelin/Interpreter\n\n","user":"admin","dateUpdated":"2018-05-22T19:00:21+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526678791369_161954439","id":"20180302-172833_1647463014","dateCreated":"2018-05-18T21:26:31+0000","dateStarted":"2018-05-22T19:00:21+0000","dateFinished":"2018-05-22T19:00:39+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10491"},{"title":"Load Dependency - Stanford Core NLP ","text":"%dep\nz.load(\"edu.stanford.nlp:stanford-corenlp:3.9.1\")\n\n//In Spark Interper Settings Add the following artifact \n//  /tmp/stanford-corenlp-full-2018-02-27/stanford-corenlp-3.9.1-models.jar","user":"admin","dateUpdated":"2018-05-22T19:08:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526679200242_-247603925","id":"20180518-213320_1292481020","dateCreated":"2018-05-18T21:33:20+0000","dateStarted":"2018-05-22T19:00:24+0000","dateFinished":"2018-05-22T19:00:42+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10492"},{"title":"Load Dependency - Spark Wrapper Stanford Core NLP","text":"%dep\nz.load(\"databricks:spark-corenlp:0.2.0-s_2.11\")\n","user":"admin","dateUpdated":"2018-05-22T19:08:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526680498393_882839249","id":"20180518-215458_1749154704","dateCreated":"2018-05-18T21:54:58+0000","dateStarted":"2018-05-22T19:00:40+0000","dateFinished":"2018-05-22T19:00:44+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10493"},{"title":"Initialize Spark Context","text":"%spark2\n\nsc\nsc.version\n","user":"admin","dateUpdated":"2018-05-22T19:00:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526678791372_159645946","id":"20180228-182438_444603187","dateCreated":"2018-05-18T21:26:31+0000","dateStarted":"2018-05-22T19:00:42+0000","dateFinished":"2018-05-22T19:01:13+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10494"},{"text":"%spark2\n\nval options = Map(\n  \"collection\" -> \"tweets\",\n  \"zkhost\" -> \"localhost:2181/solr\",\n // \"query\" -> \"USDA, 'USDA Disaster Program', wildfire, 'Florida losses', 'Texas losses', 'citrus greening'\"\n //  \"query\" -> \"USDA, 'USDA Disaster Program'\"\n   \"query\" -> \"Keyword, 'Keywork Pair'\"\n)\n\nval df = spark.read.format(\"solr\")\n  .options(options)\n  .load\n  \ndf.printSchema()\n\ndf.cache()","user":"admin","dateUpdated":"2018-05-23T16:17:58+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526678791373_159261197","id":"20180228-182512_1457175841","dateCreated":"2018-05-18T21:26:31+0000","dateStarted":"2018-05-23T15:34:20+0000","dateFinished":"2018-05-23T15:34:22+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10495"},{"text":"%spark2 \n\ndf.count()","user":"admin","dateUpdated":"2018-05-22T19:01:23+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526678791373_159261197","id":"20180301-200025_999714821","dateCreated":"2018-05-18T21:26:31+0000","dateStarted":"2018-05-22T19:01:23+0000","dateFinished":"2018-05-22T19:01:44+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10496"},{"text":"%spark2\n\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport com.databricks.spark.corenlp.functions._\n\nval df_TweetSentiment = df.filter(\"text_t is not null and language_s = 'en' and timestamp_s is not null \").select($\"timestamp_s\", $\"text_t\", $\"location\", sentiment($\"text_t\").as('sentimentScore))\n\nval df_TweetSentiment1 = df_TweetSentiment.withColumn(\"timestampZ\",  unix_timestamp($\"timestamp_s\", \"EEE MMM dd HH:mm:ss ZZZZZ yyyy\").cast(TimestampType)).drop($\"timestamp_s\")\n\ndf_TweetSentiment1.printSchema()\ndf_TweetSentiment1.take(1)\ndf_TweetSentiment1.count()\ndf_TweetSentiment1.cache()\ndf_TweetSentiment1.createOrReplaceTempView(\"TweetSentiment\")\n","user":"admin","dateUpdated":"2018-05-22T19:01:59+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526678791374_160415443","id":"20180302-184803_563005872","dateCreated":"2018-05-18T21:26:31+0000","dateStarted":"2018-05-22T19:01:59+0000","dateFinished":"2018-05-22T19:02:08+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10497"},{"title":"Average Sentiment Per Hour","text":"%sql\n\nselect hour(timestampZ), avg(sentimentScore) from TweetSentiment group by hour(timestampZ) order by hour(timestampZ) ASC\n","user":"admin","dateUpdated":"2018-05-22T19:13:06+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"scatterChart":{"xAxis":{"name":"hour(timestampZ)","index":0,"aggr":"sum"},"yAxis":{"name":"sentimentScore","index":1,"aggr":"sum"}},"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"hour(timestampZ)","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avg(sentimentScore)","index":1,"aggr":"min"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526680328587_1477783642","id":"20180518-215208_803853791","dateCreated":"2018-05-18T21:52:08+0000","dateStarted":"2018-05-22T19:02:11+0000","dateFinished":"2018-05-22T19:03:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10498"},{"title":"Average Sentiment Per Day of Year","text":"%sql\n\nselect dayofyear(timestampZ), avg(sentimentScore) from TweetSentiment group by dayofyear(timestampZ) order by dayofyear(timestampZ) ASC","user":"admin","dateUpdated":"2018-05-22T19:03:45+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526688965997_-592629649","id":"20180519-001605_1745796109","dateCreated":"2018-05-19T00:16:05+0000","dateStarted":"2018-05-22T19:03:46+0000","dateFinished":"2018-05-22T19:03:47+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10499"},{"title":"Average Sentiment Per Day of Month","text":"%sql\n\nselect dayofmonth(timestampZ), avg(sentimentScore) from TweetSentiment group by dayofmonth(timestampZ) order by dayofmonth(timestampZ) ASC","user":"admin","dateUpdated":"2018-05-22T19:03:52+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526689138261_-1665616066","id":"20180519-001858_1824102094","dateCreated":"2018-05-19T00:18:58+0000","dateStarted":"2018-05-22T19:03:52+0000","dateFinished":"2018-05-22T19:03:53+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10500"},{"title":"Count of Tweets by Sentiment","text":"%sql\n\nselect sentimentScore, count(sentimentScore)  from TweetSentiment group by sentimentScore\n","user":"admin","dateUpdated":"2018-05-22T19:03:57+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526688544742_-1268617022","id":"20180519-000904_2075379709","dateCreated":"2018-05-19T00:09:04+0000","dateStarted":"2018-05-22T19:03:57+0000","dateFinished":"2018-05-22T19:03:59+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10501"},{"title":"Tweets By Location","text":"%sql\n\nselect location, avg(sentimentScore), count(sentimentScore) from TweetSentiment group by location order by count(sentimentScore) DESC\n","user":"admin","dateUpdated":"2018-05-22T19:04:01+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":1426,"optionOpen":false,"setting":{"pieChart":{}},"commonSetting":{},"keys":[{"name":"location","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(sentimentScore)","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526688630005_133361998","id":"20180519-001030_1085980952","dateCreated":"2018-05-19T00:10:30+0000","dateStarted":"2018-05-22T19:04:01+0000","dateFinished":"2018-05-22T19:04:03+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10502"},{"text":"%sql\n\nselect text_t from TweetSentiment where sentimentScore = 0","user":"admin","dateUpdated":"2018-05-22T19:11:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526689361102_1269354168","id":"20180519-002241_2092576724","dateCreated":"2018-05-19T00:22:41+0000","dateStarted":"2018-05-22T19:11:02+0000","dateFinished":"2018-05-22T19:11:03+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10503"},{"text":"%sql\n\nselect text_t from TweetSentiment where sentimentScore = 1","user":"admin","dateUpdated":"2018-05-22T19:11:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526690801998_-1617199002","id":"20180519-004641_1538117403","dateCreated":"2018-05-19T00:46:41+0000","dateStarted":"2018-05-22T19:11:06+0000","dateFinished":"2018-05-22T19:11:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10504"},{"text":"%sql\n\nselect text_t from TweetSentiment where sentimentScore = 2","user":"admin","dateUpdated":"2018-05-21T16:04:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526690816875_-1436520260","id":"20180519-004656_318983730","dateCreated":"2018-05-19T00:46:56+0000","dateStarted":"2018-05-21T16:04:19+0000","dateFinished":"2018-05-21T16:04:19+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10505"},{"text":"%sql\n\nselect text_t from TweetSentiment where sentimentScore = 3\n","user":"admin","dateUpdated":"2018-05-21T16:04:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526689527195_389831863","id":"20180519-002527_388652643","dateCreated":"2018-05-19T00:25:27+0000","dateStarted":"2018-05-21T16:04:19+0000","dateFinished":"2018-05-21T16:04:19+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10506"},{"text":"%sql\n\nselect text_t from TweetSentiment where sentimentScore = 4\n","user":"admin","dateUpdated":"2018-05-21T15:48:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526690841322_1943929549","id":"20180519-004721_1186877698","dateCreated":"2018-05-19T00:47:21+0000","dateStarted":"2018-05-21T15:48:01+0000","dateFinished":"2018-05-21T15:48:01+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10507"},{"title":"Sentiment Test","text":"%spark2\n\n\nimport org.apache.spark.sql.functions._\nimport com.databricks.spark.corenlp.functions._\n\nimport sqlContext.implicits._\n\nval input = Seq(\n  (1, \"Stanford University is located in California. It is a great university.\")\n).toDF(\"id\", \"text\")\n\nval output = input\n  .select(\"text\")\n  .select(explode(ssplit($\"text\")).as('sen))\n  //.select(sentiment($\"sen\").as('senti))\n  //.select('sen, tokenize('sen).as('words), ner('sen).as('nerTags), sentiment('sen).as('sentiment))\n\n//output.printSchema()\n\nval Sentiment = output.select( $\"sen\", sentiment($\"sen\") )\n\n//output.show(truncate = false)\n\nSentiment.take(1)","user":"admin","dateUpdated":"2018-05-18T23:04:29+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526678791376_170418915","id":"20180413-135427_1323466160","dateCreated":"2018-05-18T21:26:31+0000","dateStarted":"2018-05-18T23:01:50+0000","dateFinished":"2018-05-18T23:02:41+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10508"},{"text":"%sql\n","user":"admin","dateUpdated":"2018-05-18T23:09:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526684949663_-187016700","id":"20180518-230909_1482460435","dateCreated":"2018-05-18T23:09:09+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10509"}],"name":"Solr To Spark NLP","id":"2DF9WQ826","angularObjects":{"2CHS8UYQQ:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}